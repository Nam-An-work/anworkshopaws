<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.144.0">
    <meta name="description" content="">
<meta name="author" content="namannguyenkhoa@gmail.com">

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>9. Warehouse on Redshift :: Optimizing Data Pipelines for Real-time Analysis and Transformation on AWS</title>

    
    <link href="/css/nucleus.css?1740910362" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1740910362" rel="stylesheet">
    <link href="/css/hybrid.css?1740910362" rel="stylesheet">
    <link href="/css/featherlight.min.css?1740910362" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1740910362" rel="stylesheet">
    <link href="/css/auto-complete.css?1740910362" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1740910362" rel="stylesheet">
    <link href="/css/theme.css?1740910362" rel="stylesheet">
    <link href="/css/hugo-theme.css?1740910362" rel="stylesheet">
    
    <link href="/css/theme-workshop.css?1740910362" rel="stylesheet">
    
    

    <script src="/js/jquery-3.3.1.min.js?1740910362"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/9-warehouseonredshift/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="/">

<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#f90;fill-rule:evenodd;}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09,10.85a4.7,4.7,0,0,0,.19,1.48,7.73,7.73,0,0,0,.54,1.19.77.77,0,0,1,.12.38.64.64,0,0,1-.32.49l-1,.7a.83.83,0,0,1-.44.15.69.69,0,0,1-.49-.23,3.8,3.8,0,0,1-.6-.77q-.25-.42-.51-1a6.14,6.14,0,0,1-4.89,2.3,4.54,4.54,0,0,1-3.32-1.19,4.27,4.27,0,0,1-1.22-3.2A4.28,4.28,0,0,1,3.61,7.75,6.06,6.06,0,0,1,7.69,6.46a12.47,12.47,0,0,1,1.76.13q.92.13,1.91.36V5.73a3.65,3.65,0,0,0-.79-2.66A3.81,3.81,0,0,0,7.86,2.3a7.71,7.71,0,0,0-1.79.22,12.78,12.78,0,0,0-1.79.57,4.55,4.55,0,0,1-.58.22l-.26,0q-.35,0-.35-.52V2a1.09,1.09,0,0,1,.12-.58,1.2,1.2,0,0,1,.47-.35A10.88,10.88,0,0,1,5.77.32,10.19,10.19,0,0,1,8.36,0a6,6,0,0,1,4.35,1.35,5.49,5.49,0,0,1,1.38,4.09ZM7.34,13.38a5.36,5.36,0,0,0,1.72-.31A3.63,3.63,0,0,0,10.63,12,2.62,2.62,0,0,0,11.19,11a5.63,5.63,0,0,0,.16-1.44v-.7a14.35,14.35,0,0,0-1.53-.28,12.37,12.37,0,0,0-1.56-.1,3.84,3.84,0,0,0-2.47.67A2.34,2.34,0,0,0,5,11a2.35,2.35,0,0,0,.61,1.76A2.4,2.4,0,0,0,7.34,13.38Zm13.35,1.8a1,1,0,0,1-.64-.16,1.3,1.3,0,0,1-.35-.65L15.81,1.51a3,3,0,0,1-.15-.67.36.36,0,0,1,.41-.41H17.7a1,1,0,0,1,.65.16,1.4,1.4,0,0,1,.33.65l2.79,11,2.59-11A1.17,1.17,0,0,1,24.39.6a1.1,1.1,0,0,1,.67-.16H26.4a1.1,1.1,0,0,1,.67.16,1.17,1.17,0,0,1,.32.65L30,12.39,32.88,1.25A1.39,1.39,0,0,1,33.22.6a1,1,0,0,1,.65-.16h1.54a.36.36,0,0,1,.41.41,1.36,1.36,0,0,1,0,.26,3.64,3.64,0,0,1-.12.41l-4,12.86a1.3,1.3,0,0,1-.35.65,1,1,0,0,1-.64.16H29.25a1,1,0,0,1-.67-.17,1.26,1.26,0,0,1-.32-.67L25.67,3.64,23.11,14.34a1.26,1.26,0,0,1-.32.67,1,1,0,0,1-.67.17Zm21.36.44a11.28,11.28,0,0,1-2.56-.29,7.44,7.44,0,0,1-1.92-.67,1,1,0,0,1-.61-.93v-.84q0-.52.38-.52a.9.9,0,0,1,.31.06l.42.17a8.77,8.77,0,0,0,1.83.58,9.78,9.78,0,0,0,2,.2,4.48,4.48,0,0,0,2.43-.55,1.76,1.76,0,0,0,.86-1.57,1.61,1.61,0,0,0-.45-1.16A4.29,4.29,0,0,0,43,9.22l-2.41-.76A5.15,5.15,0,0,1,38,6.78a3.94,3.94,0,0,1-.83-2.41,3.7,3.7,0,0,1,.45-1.85,4.47,4.47,0,0,1,1.19-1.37A5.27,5.27,0,0,1,40.51.29,7.4,7.4,0,0,1,42.6,0a8.87,8.87,0,0,1,1.12.07q.57.07,1.08.19t.95.26a4.27,4.27,0,0,1,.7.29,1.59,1.59,0,0,1,.49.41.94.94,0,0,1,.15.55v.79q0,.52-.38.52a1.76,1.76,0,0,1-.64-.2,7.74,7.74,0,0,0-3.2-.64,4.37,4.37,0,0,0-2.21.47,1.6,1.6,0,0,0-.79,1.48,1.58,1.58,0,0,0,.49,1.18,4.94,4.94,0,0,0,1.83.92L44.55,7a5.08,5.08,0,0,1,2.57,1.6A3.76,3.76,0,0,1,47.9,11a4.21,4.21,0,0,1-.44,1.93,4.4,4.4,0,0,1-1.21,1.47,5.43,5.43,0,0,1-1.85.93A8.25,8.25,0,0,1,42.05,15.62Z"></path><path class="cls-2" d="M45.19,23.81C39.72,27.85,31.78,30,25,30A36.64,36.64,0,0,1,.22,20.57c-.51-.46-.06-1.09.56-.74A49.78,49.78,0,0,0,25.53,26.4,49.23,49.23,0,0,0,44.4,22.53C45.32,22.14,46.1,23.14,45.19,23.81Z"></path><path class="cls-2" d="M47.47,21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74,3.13-2.2,8.27-1.57,8.86-.83s-.16,5.89-3.09,8.35c-.45.38-.88.18-.68-.32C46.69,25.8,48.17,22.11,47.47,21.21Z"></path></svg>

</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1740910362"></script>
<script type="text/javascript" src="/js/auto-complete.js?1740910362"></script>
<script type="text/javascript">
    
        var baseurl = "http:\/\/Nam-An-work.github.io\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1740910362"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/1-introduce/" title="1. Introduction" class="dd-item 
        
        
        
        ">
      <a href="/1-introduce/">
          1. Introduction
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/2-ingestandstore/" title="2. Ingest and Store" class="dd-item 
        
        
        
        ">
      <a href="/2-ingestandstore/">
          2. Ingest and Store
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/2-ingestandstore/2.1-s3/" title="2.1. Create S3 Bucket" class="dd-item 
        
        
        
        ">
      <a href="/2-ingestandstore/2.1-s3/">
          2.1. Create S3 Bucket
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-ingestandstore/2.2-kn/" title="2.2. Create Data Firehose" class="dd-item 
        
        
        
        ">
      <a href="/2-ingestandstore/2.2-kn/">
          2.2. Create Data Firehose
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-ingestandstore/2.3-dummy/" title="2.3. Generate Dummy Data" class="dd-item 
        
        
        
        ">
      <a href="/2-ingestandstore/2.3-dummy/">
          2.3. Generate Dummy Data
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/3-catalogdata/" title="3. Catalog Data" class="dd-item 
        
        
        
        ">
      <a href="/3-catalogdata/">
          3. Catalog Data
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/3-catalogdata/3.1-iam/" title="3.1. Create Iam role" class="dd-item 
        
        
        
        ">
      <a href="/3-catalogdata/3.1-iam/">
          3.1. Create Iam role
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/3-catalogdata/3.2-glue/" title="3.2. Create AWS Glue Crawlers" class="dd-item 
        
        
        
        ">
      <a href="/3-catalogdata/3.2-glue/">
          3.2. Create AWS Glue Crawlers
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/3-catalogdata/3.3-athena/" title="3.3. Query ingested data using Amazon Athena" class="dd-item 
        
        
        
        ">
      <a href="/3-catalogdata/3.3-athena/">
          3.3. Query ingested data using Amazon Athena
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/4-datatransformation/" title="4. Data Transformation" class="dd-item 
        
        
        
        ">
      <a href="/4-datatransformation/">
          4. Data Transformation
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/4-datatransformation/4.1-glue-inter/" title="4.1. Transform Data with AWS Glue (interactive sessions)" class="dd-item 
        
        
        
        ">
      <a href="/4-datatransformation/4.1-glue-inter/">
          4.1. Transform Data with AWS Glue (interactive sessions)
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/4-datatransformation/4.2-glue-grap/" title="4.2. Transform Data with AWS Glue Studio (graphical interface)" class="dd-item 
        
        
        
        ">
      <a href="/4-datatransformation/4.2-glue-grap/">
          4.2. Transform Data with AWS Glue Studio (graphical interface)
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/4-datatransformation/4.3-glue-data/" title="4.3. Transform Data with AWS Glue DataBrew" class="dd-item 
        
        
        
        ">
      <a href="/4-datatransformation/4.3-glue-data/">
          4.3. Transform Data with AWS Glue DataBrew
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/4-datatransformation/4.4-emr/" title="4.4. Transform Data with EMR" class="dd-item 
        
        
        
        ">
      <a href="/4-datatransformation/4.4-emr/">
          4.4. Transform Data with EMR
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/5-analyzewithathena/" title="5. Analyze with Athena" class="dd-item 
        
        
        
        ">
      <a href="/5-analyzewithathena/">
          5. Analyze with Athena
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/6-analyzewithkinesis/" title="6. Analyze with Kinesis Data Analytics" class="dd-item 
        
        
        
        ">
      <a href="/6-analyzewithkinesis/">
          6. Analyze with Kinesis Data Analytics
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/6-analyzewithkinesis/6.1-iam/" title="6.1 Create Iam Role" class="dd-item 
        
        
        
        ">
      <a href="/6-analyzewithkinesis/6.1-iam/">
          6.1 Create Iam Role
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/6-analyzewithkinesis/6.2-kin/" title="6.2. Create Kinesis Data Stream" class="dd-item 
        
        
        
        ">
      <a href="/6-analyzewithkinesis/6.2-kin/">
          6.2. Create Kinesis Data Stream
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/6-analyzewithkinesis/6.3-glue/" title="6.3. Create Glue Catalog Table" class="dd-item 
        
        
        
        ">
      <a href="/6-analyzewithkinesis/6.3-glue/">
          6.3. Create Glue Catalog Table
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/6-analyzewithkinesis/6.4-stu/" title="6.4. Create Analytics Streaming Application Studio Notebook" class="dd-item 
        
        
        
        ">
      <a href="/6-analyzewithkinesis/6.4-stu/">
          6.4. Create Analytics Streaming Application Studio Notebook
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/7-quicksight/" title="7. Visualize in Quicksight" class="dd-item 
        
        
        
        ">
      <a href="/7-quicksight/">
          7. Visualize in Quicksight
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/8-servewithlambda/" title="8. Serve with Lambda" class="dd-item 
        
        
        
        ">
      <a href="/8-servewithlambda/">
          8. Serve with Lambda
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/9-warehouseonredshift/" title="9. Warehouse on Redshift" class="dd-item 
        
        active
        
        ">
      <a href="/9-warehouseonredshift/">
          9. Warehouse on Redshift
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/10-cleanup/" title="10. Clean up resources  " class="dd-item 
        
        
        
        ">
      <a href="/10-cleanup/">
          10. Clean up resources  
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="https://aws.amazon.com/blogs"><i class='fab fa-aws'></i> AWS Study Group - Blog</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://www.facebook.com/groups/awsstudygroupfcj"><i class='fab fa-facebook'></i> AWS Study Group - FB Group</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
        <li>
          <a class="padding">
            <i class="fas fa-language fa-fw"></i>
          <div class="select-style">
            <select id="select-language" onchange="location = this.value;">
          
          
          
              
              
                  
                    
                    
                      <option id="en" value="http://Nam-An-work.github.io/9-warehouseonredshift/" selected>English</option>
                    
                  
              
                  
              
          
              
              
                  
              
                  
                    
                    
                      <option id="vi" value="http://Nam-An-work.github.io/vi/9-warehouseonredshift/">Tiếng Việt</option>
                    
                  
              
          
        </select>
        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
          width="255px" height="255px" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255;" xml:space="preserve">
          <g>
            <g id="arrow-drop-down">
              <polygon points="0,63.75 127.5,191.25 255,63.75 		" />
            </g>
          </g>
        </svg>
        </div>
        </a>
        </li>
      
      
      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      <left>
    
     <b> Workshop</b> <br>
    <img src="https://hitwebcounter.com/counter/counter.php?page=7920860&style=0038&nbdigits=9&type=page&initCount=0" title="Migrate" Alt="web counter"   border="0" /></a>  <br>
     <b> <a href="https://cloudjourney.awsstudygroup.com/">Cloud Journey</a></b> <br>
    <img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0" title="Total CLoud Journey" Alt="web counter"   border="0"   />
     
</left>
<left>
    <br>
    <br>
        <b> Last Updated </b> <br>
        <i><font color=orange>18-04-2024</font></i>
    </left>
    <left>
        <br>
        <br>
            <b> Team </b> <br>
           
            <i> <a href="https://www.linkedin.com/in/sutrinh/"  style="color:orange">Sử Trịnh  </a> <br>
                <a href="https://www.linkedin.com/in/jotaguy"  style="color:orange">Gia Hưng </a> <br>
                <a href="https://www.linkedin.com/in/hiepnguyendt"  style="color:orange">Thanh Hiệp </a>
               
        </i>
        </left>

<script async defer src="https://buttons.github.io/buttons.js"></script>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            <a href='/'>Optimizing Data Pipelines for Real-time Analysis and Transformation on AWS</a> > 9. Warehouse on Redshift
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#create-redshift-iam-role">Create Redshift IAM Role</a></li>
        <li><a href="#create-redshift-cluster">Create Redshift cluster</a></li>
        <li><a href="#create-s3-gateway-endpoint">Create S3 Gateway Endpoint</a></li>
        <li><a href="#verify-and-add-rules-to-the-default-security-group">Verify and add rules to the default security group</a></li>
        <li><a href="#create-redshift-connection-under-glue-connection">Create Redshift connection under Glue Connection.</a></li>
        <li><a href="#create-schema-and-redshift-tables">Create schema and redshift tables.</a></li>
        <li><a href="#use-jupyter-notebook-in-aws-glue-for-interactive-etl-development">Use Jupyter Notebook in AWS Glue for interactive ETL development</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              9. Warehouse on Redshift
            </h1>
          

        



	<p><img src="/anworkshopaws/images/a-12.png" alt="pic">
In this module, we are going to setup an Amazon Redshift cluster, and use AWS Glue to load the data into Amazon Redshift. We will learn about several design considerations and best practices on creating and loading data into tables in Redshift, and running queries against it.</p>
<h3 id="create-redshift-iam-role">Create Redshift IAM Role</h3>
<p>Go to: <a href="https://console.aws.amazon.com/iam/home?region=us-east-1#/roles">Redshift Console</a></p>
<ul>
<li>Click on <strong>Create role</strong></li>
<li>Select <strong>Redshift</strong> under Use case and Use cases for other AWS services:</li>
<li>Select <strong>Redshift - customizable</strong></li>
<li>Click Next
<img src="/anworkshopaws/images/9-warehouseonredshift/1.png" alt="pic">
In Search box, search and check following two policies</li>
<li><strong>AmazonS3FullAccess</strong></li>
<li><strong>AWSGlueConsoleFullAccess</strong></li>
<li>Click Next</li>
<li>Give Role Name as <strong>Analyticsworkshop_RedshiftRole</strong>
<img src="/anworkshopaws/images/9-warehouseonredshift/2.png" alt="pic"></li>
<li>Optionally add Tags, e.g.: workshop: AnalyticsOnAWS</li>
<li>Click <strong>Create role</strong>
<img src="/anworkshopaws/images/9-warehouseonredshift/3.png" alt="pic"></li>
</ul>
<h3 id="create-redshift-cluster">Create Redshift cluster</h3>
<p>Go to <a href="https://console.aws.amazon.com/redshiftv2/home?region=us-east-1">Redshift cluster</a></p>
<ul>
<li>Click <strong>Provision</strong> and manage clusters from menu panel on the left</li>
<li>Click <strong>Create Cluster</strong></li>
<li>Leave <strong>Cluster identifier</strong> as redshift-cluster-1</li>
<li>Select <strong>dc2.large</strong> as Node Type</li>
<li>Select <strong>Number of Nodes</strong> as 2.</li>
<li>Verify Configuration summary.
<img src="/anworkshopaws/images/9-warehouseonredshift/4.png" alt="pic"></li>
<li>Change <strong>Master user name</strong> to <strong>admin</strong></li>
<li>Enter <strong>Master user password</strong>
<img src="/anworkshopaws/images/9-warehouseonredshift/5.png" alt="pic"></li>
<li>Under <strong>Cluster permissions</strong></li>
<li>Click <strong>Associate IAM role</strong></li>
<li>Select previously created <strong>Analyticsworkshop_RedshiftRole</strong></li>
<li>Click <strong>Associate IAM roles</strong></li>
<li><strong>Analyticsworkshop_RedshiftRole</strong> should appear under Associated IAM roles
<img src="/anworkshopaws/images/9-warehouseonredshift/6.png" alt="pic"></li>
<li>Leave <strong>Additional configurations</strong> to default. It uses default VPC and default security group.</li>
<li>Click <strong>Create cluster</strong></li>
</ul>
<h3 id="create-s3-gateway-endpoint">Create S3 Gateway Endpoint</h3>
<p>Go to: <a href="https://us-east-1.console.aws.amazon.com/vpc/home?region=us-east-1#Endpoints:">AWS VPC Console</a></p>
<ul>
<li>Click <strong>Create endpoint</strong></li>
<li>Name tag - optional: RedshiftS3EP</li>
<li>Select <strong>AWS Services</strong> under <strong>Service category</strong> (which is the default selection)
<img src="/anworkshopaws/images/9-warehouseonredshift/7.png" alt="pic"></li>
<li>Under <strong>Service name</strong> search box, search for <strong>&ldquo;s3&rdquo;</strong> and hit enter/return.</li>
<li><strong>com.amazonaws.us-east-1.s3</strong> should come up as search result. Select this option with type as Gateway</li>
<li>Under <strong>VPC</strong>, chose default VPC. This is the same VPC which was used for configuring redshift cluster
<img src="/anworkshopaws/images/9-warehouseonredshift/8.png" alt="pic"></li>
<li>Once you have double checked VPC id, move to configuring <strong>Route tables</strong> section.</li>
<li>Select the listed route table (this should be the main route table). You can verify this by checking <strong>Yes</strong> under <strong>Main</strong> column.</li>
<li>Leave <strong>Policy</strong> as default. (Full access)
<img src="/anworkshopaws/images/9-warehouseonredshift/9.png" alt="pic"></li>
<li>Optionally add Tags, e.g.: * workshop: AnalyticsOnAWS
<img src="/anworkshopaws/images/9-warehouseonredshift/10.png" alt="pic"></li>
<li>Click <strong>Create endpoint</strong>. It should take a couple of seconds to provision this. Once this is ready, you should see Status as - Available against the newly created S3 endpoint.</li>
</ul>
<h3 id="verify-and-add-rules-to-the-default-security-group">Verify and add rules to the default security group</h3>
<p>Go to: <a href="https://us-east-1.console.aws.amazon.com/vpc/home?region=us-east-1#SecurityGroups:">VPC Security Groups</a></p>
<ul>
<li>Select the Redshift security group. It should be the default security if it was not changed during the Redshift cluster creation step.
<img src="/anworkshopaws/images/9-warehouseonredshift/11.png" alt="pic"></li>
<li>Click <strong>Edit inbound rules</strong>
<img src="/anworkshopaws/images/9-warehouseonredshift/12.png" alt="pic"></li>
<li>Click <strong>Edit outbound rules</strong>
<img src="/anworkshopaws/images/9-warehouseonredshift/13.png" alt="pic"></li>
</ul>
<h3 id="create-redshift-connection-under-glue-connection">Create Redshift connection under Glue Connection.</h3>
<p>Go to: <a href="https://us-east-1.console.aws.amazon.com/gluestudio/home?region=us-east-1#/connectors">Glue Connections Console</a></p>
<ul>
<li>Under <strong>Connections</strong> Click <strong>Create connection</strong></li>
<li>Give <strong>Connection name</strong> as analytics_workshop.</li>
<li>Choose <strong>Connection</strong> type as Amazon Redshift.
<img src="/anworkshopaws/images/9-warehouseonredshift/14.png" alt="pic">
Setup Connections access</li>
<li>Choose <strong>Database instances</strong> as <strong>redshift-cluster-1</strong></li>
<li>Database name and Username should get populated automatically as <strong>dev</strong> and <strong>admin</strong> respectively.</li>
<li>Password: Enter the password which you have used during Redshift cluster setup.</li>
<li>Click <strong>Create connection</strong>
<img src="/anworkshopaws/images/9-warehouseonredshift/15.png" alt="pic"></li>
</ul>
<h3 id="create-schema-and-redshift-tables">Create schema and redshift tables.</h3>
<p>Go to: <a href="https://us-east-1.console.aws.amazon.com/redshiftv2/home?region=us-east-1#query-editor:">Redshift Query Editor</a></p>
<ul>
<li>
<p>Click <strong>Connect</strong> to database</p>
</li>
<li>
<p><strong>Connection</strong>: Create a new connection</p>
</li>
<li>
<p><strong>Authentication</strong>: Temporary credentials</p>
</li>
<li>
<p><strong>cluster: redshift</strong>-cluster-1</p>
</li>
<li>
<p><strong>Database name</strong>: dev</p>
</li>
<li>
<p><strong>Database user</strong>: admin</p>
</li>
<li>
<p>Click <strong>Connect</strong>
<img src="/anworkshopaws/images/9-warehouseonredshift/16.png" alt="pic"></p>
</li>
<li>
<p>Execute the queries below to create schema and tables for raw and reference data.

<div class="notices note" ><pre><code>        CREATE schema redshift_lab;
</code></pre>
</div>
</p>
</li>
</ul>

<div class="notices note" ><pre><code>        --    Create f_raw_1 table.
        CREATE TABLE IF not EXISTS redshift_lab.f_raw_1 (
        uuid            varchar(256),
        device_ts         timestamp,
        device_id        int,
        device_temp        int,
        track_id        int,
        activity_type        varchar(128),
        load_time        int
        );
</code></pre>
</div>

<p>
<div class="notices note" ><pre><code>        --    Create d_ref_data_1 table.
        CREATE TABLE IF NOT EXISTS redshift_lab.d_ref_data_1 (
        track_id        int,
        track_name    varchar(128),
        artist_name    varchar(128)
        );
</code></pre>
</div>

<img src="/anworkshopaws/images/9-warehouseonredshift/17.png" alt="pic"></p>
<h3 id="use-jupyter-notebook-in-aws-glue-for-interactive-etl-development">Use Jupyter Notebook in AWS Glue for interactive ETL development</h3>
<p>Download and save this file locally on your laptop <a href="https://static.us-east-1.prod.workshops.aws/public/252b2158-4ee1-410c-b074-58190ec31cd6/static/notebooks/analytics-workshop-redshift-glueis-notebook.ipynb">file</a></p>
<ul>
<li>Go to: <a href="https://us-east-1.console.aws.amazon.com/gluestudio/home?region=us-east-1#/jobs">Glue Studio jobs</a></li>
<li>Select <strong>Jupyter Notebook</strong> option</li>
<li>Select <strong>Upload and edit an existing notebook</strong></li>
<li>Click <strong>Choose file</strong></li>
<li>Browse and upload <strong>analytics-workshop-redshift-glueis-notebook.ipynb</strong> which you downloaded earlier</li>
<li>Click <strong>Create</strong>
<img src="/anworkshopaws/images/9-warehouseonredshift/18.png" alt="pic">
Under Notebook setup and Initial configuration</li>
<li>Job name: AnalyticsOnAWS-Redshift</li>
<li>IAM role Analyticsworkshop-GlueISRole</li>
<li>Leave Kernel to default as Spark</li>
<li>Click Start notebook
Execute the following queries to check the number of records in raw and reference data table.

<div class="notices note" ><pre><code>    select count(1) from redshift_lab.f_raw_1;

    select count(1) from redshift_lab.d_ref_data_1;
</code></pre>
</div>


<div class="notices note" ><pre><code>    select 
    track_name, 
    artist_name, 
    count(1) frequency
    from 
    redshift_lab.f_raw_1 fr
    inner join 
    redshift_lab.d_ref_data_1 drf
    on 
    fr.track_id = drf.track_id
    where 
    activity_type = 'Running'
    group by 
    track_name, artist_name
    order by 
    frequency desc
    limit 10;
</code></pre>
</div>
</li>
</ul>





<footer class=" footline" >
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/8-servewithlambda/" title="8. Serve with Lambda"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/10-cleanup/" title="10. Clean up resources  " style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1740910362"></script>
    <script src="/js/perfect-scrollbar.min.js?1740910362"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1740910362"></script>
    <script src="/js/jquery.sticky.js?1740910362"></script>
    <script src="/js/featherlight.min.js?1740910362"></script>
    <script src="/js/highlight.pack.js?1740910362"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1740910362"></script>
    <script src="/js/learn.js?1740910362"></script>
    <script src="/js/hugo-learn.js?1740910362"></script>

    <link href="/mermaid/mermaid.css?1740910362" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1740910362"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-158079754-2', 'auto');
  ga('send', 'pageview');

</script>
  </body>
</html>
